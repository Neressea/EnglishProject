{%extends "base.html" %}
{% block content %}

	<div class="results">
		<p>
			<span>Vocabulary {{percentages[0]}}%</span> 
			<span>Grammar {{percentages[1]}}%</span>
			<span>Comprehension {{percentages[2]}}%</span>
		</p>
		<p class="info">
			Congratulation! You finished the lesson. It will now disappear from your trainings.
			You can do this lesson again from your history (in your account information).
		</p>
	</div>

	<div class="lesson" method="post" action="/check">
		<input type="hidden" name="id-lesson" value="{{lesson.key().id()}}" />
		<h1 class="lesson-title">{{lesson.title}}</h1>
		<p>{{lesson.difficulty}}</p>

		{% set i = 0 %}
		{% for story in stories %}
			{% set i = i + 1 %}

			<div class="story" id="story{{i}}" \>

				<h2>Story {{i}} : {{story.title}}</h2>

				{% if story.type_of_story == "video" %}
					<iframe width="640" height="360" src="{{story.text}}" frameborder="0" allowfullscreen></iframe>
				{% else %}
					<p>{{story.text}}</p>
				{% endif %}

				<h3>Questions</h3>

				<div class="vocabulary-questions">
					<h4>Vocabulary questions</h4>
					{% set j = 0 %}

					{% for a in story.questions_vocabulary %}

						{% set j = j+1 %}
						{% set part = vocabulary_parts[i-1+j-1] %}

						<h5>Question {{j}}</h5>

						<div class="vocabulary-question" id="vocabulary-question{{i}}{{j}}">
							<p>{{part | safe}}</p>
						</div>

					{% endfor %}

				</div>

				<div class="grammar-questions">
					<h4>Grammar questions</h4>
					{% set j = 0 %}

					{% for gramm in story.questions_grammar %}
						{% set j = j+1 %}
						<h5>Question {{j}}</h5>

						<div class="grammar-question" id="grammar-question{{i}}{{j}}">
							<p>{{gramm.split("|")[0]}}</p>

							{% if gramm.split("|")[1] == grammar_got[i-1+j-1] %}
								<input class="answer_true" type="text" name="pseudo" value="{{grammar_got[i-1+j-1]}}" disabled="disabled" />
							{% else %}
								<input class="answer_false" type="text" name="pseudo" value="{{grammar_got[i-1+j-1]}}" disabled="disabled" />
								<input class="answer_true" type="text" name="pseudo" value="{{gramm.split("|")[1]}}" disabled="disabled" />
							{% endif %}
						</div>

					{% endfor %}
				</div>

				<div class="comprehension-questions">
					<h4>Comprehension questions</h4>
					{% set j = 0 %}

					{% for compr in story.questions_comprehension %}
						{% set j = j+1 %}
						<h5>Question {{j}}</h5>

						<div class="comprehension-answer" id="comprehension-answer{{i}}{{j}}">
							<p>{{compr.split("|")[0]}}</p>

							{% if compr.split("|")[1] == comprehension_got[i-1+j-1] %}
								<input class="answer_true" type="text" name="pseudo" value="{{comprehension_got[i-1+j-1]}}" disabled="disabled" />
							{% else %}
								<input class="answer_false" type="text" name="pseudo" value="{{comprehension_got[i-1+j-1]}}" disabled="disabled" />
								<input class="answer_true" type="text" name="pseudo" value="{{compr.split("|")[1]}}" disabled="disabled" />
							{% endif %}
						</div>

					{% endfor %}
				</div>
			</div>

		{% endfor %}

		<input type="submit" value="Check !"/>

		<p class="created">Posté le {{lesson.created.strftime('%A %d %B %Y')}} à {{lesson.created.strftime('%H:%M:%S')}}</p>
		<p class="created">Modifié la dernière fois le {{lesson.created.strftime('%A %d %B %Y')}} à {{lesson.created.strftime('%H:%M:%S')}}</p>
	</div>

{% endblock %}